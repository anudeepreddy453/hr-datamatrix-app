from app import app, db, User
from werkzeug.security import generate_password_hash
from datetime import datetime

with app.app_context():
    # Delete all existing users
    User.query.delete()
    db.session.commit()
    print("ğŸ—‘ï¸  Deleted all users")
    
    # Create fresh users with guaranteed working credentials
    users = [
        {
            "name": "Admin User",
            "email": "admin@test.com",
            "password": "admin123",
            "role": "admin",
            "department": "IT"
        },
        {
            "name": "Test User", 
            "email": "test@test.com",
            "password": "test123",
            "role": "user",
            "department": "IT"
        },
        {
            "name": "HR Manager",
            "email": "hr@test.com", 
            "password": "hr123",
            "role": "hr_manager",
            "department": "HR"
        }
    ]
    
    for user_data in users:
        user = User(
            name=user_data['name'],
            email=user_data['email'],
            password_hash=generate_password_hash(user_data['password']),
            role=user_data['role'],
            department=user_data['department'],
            status='active',  # Always active
            created_at=datetime.utcnow(),
            approved_at=datetime.utcnow()
        )
        db.session.add(user)
        print(f"âœ… Created: {user_data['email']} / {user_data['password']}")
    
    db.session.commit()
    print("\nğŸ‰ All users created successfully!")
    print("\nğŸ“‹ Try logging in with:")
    print("Email: admin@test.com")
    print("Password: admin123")
